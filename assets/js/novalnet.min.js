/**
 * Novalnet Function action
 *
 * @category   Novalnet function action
 * @package    edd-novalnet-gateway
 * @copyright  Novalnet (https://www.novalnet.de)
 * @license    https://www.novalnet.de/payment-plugins/kostenlos/lizenz
 */
function day_blur_action(e,t){var n,a;a=n=jQuery("#"+t+"_day").val(),"0"!=n&&""!=n&&n.length<2?a="0"+n:"0"==n?a=n.replace("0","01"):"00"==n&&(a=n.replace("00","01")),jQuery("#"+t+"_day").val(a)}function year_validation(e,t){var n=new Date,a=n.getFullYear()-18,o=n.getFullYear()-91,r=jQuery("#"+t+"_year").val(),l=r.length;let i=parseInt(a.toString().substring(0,l)),u=parseInt(o.toString().substring(0,l)),s=r.substring(0,l);if((8!=e.keyCode||46!=e.keyCode)&&(s>i||s<u||isNaN(s)))return jQuery("#"+t+"_year").val(r.substring(0,l-1)),e.preventDefault(),e.stopImmediatePropagation(),!1}function allow_date(e){e.target.selectionStart;var t,n="which"in e?e.which:e.keyCode,a=/^(?:[0-9]+$)/,o=e.target,r=jQuery(o).attr("id");"novalnet_sepa_day"==r||"novalnet_sepa_month"==r||"novalnet_sepa_year"==r?t=r.match(/novalnet_sepa/g):"novalnet_invoice_day"!=r&&"novalnet_invoice_month"!=r&&"novalnet_invoice_year"!=r||(t=r.match(/novalnet_invoice/g));var l=new Date,i=l.getFullYear()-18,u=l.getFullYear()-91;monthAutocomplete(document.getElementById(t+"_month"),["01","02","03","04","05","06","07","08","09","10","11","12"]);for(var s=[],c=i;c>=u;c--)s.push(""+c);return yearAutocomplete(document.getElementById(t+"_year"),s),jQuery("#"+t+"_day").on("keypress textInput",(function(e){var o=e.target.selectionStart,r=e.which||e.originalEvent.data.charCodeAt(0),l=String.fromCharCode(r);if(day_val=jQuery("#"+t+"_day").val(),1==day_val.length){if(l>2&&day_val.charAt(0)>2&&0==o)return(a=/^[0-2]$/).test(String.fromCharCode(n))||0===n||8===n;if(day_val.charAt(0)>=4&&l>3&&(0==o||1==o)||3==day_val.charAt(0)&&l>1&&1==o)return!1;if(0==o&&1==day_val.charAt(0)&&l>3||0==o&&2==day_val.charAt(0)&&l>2||1==day_val.length&&1==o&&day_val>3)return!1;if(0==day_val.charAt(0)&&l>3&&0==o)return!1}})),jQuery("#"+t+"_day").on("blur",(function(e){day_blur_action(e,t)})),jQuery("#"+t+"_year").on("input",(function(e){year_validation(e,t)})),jQuery("#"+t+"_month").on("blur",(function(e){var n=this.value;1==n.length&&"0"==n||2==n.length&&"00"==n?jQuery("#"+t+"_month").val("01"):1==n.length&&jQuery("#"+t+"_month").val("0"+n)})),jQuery("#"+t+"_month").keypress((function(e){var n="which"in e?e.which:e.keyCode,o=String.fromCharCode(n),r=jQuery("#"+t+"_month").val(),l=e.target.selectionStart;return a=jQuery("#"+t+"_month").val()>0?/^(?:[0-2]+$)/:/^(?:[0-9]+$)/,!(r>2&&1==r.length&&0==l&&o>0||(2==r||1==r||0==r)&&1==r.length&&0==l&&o>1)&&(!(r>=2&&1==r.length&&1==l&&o>=0)&&(a.test(String.fromCharCode(n))||0===n||8===n))})),a.test(String.fromCharCode(n))||0===n||8===n}function monthAutocomplete(e,t){var n,a=e.id;function o(e){if(!e)return!1;removeActiveValue(e),isNaN(n)&&(n=0),n>=e.length&&(n=0),n<0&&(n=e.length-1),e[n].classList.add("autocomplete-active");var t=jQuery(e[n]);jQuery("#"+a).val(jQuery(".month_active",t).val())}e.addEventListener("input",(function(a){var o,r,l,i=this.value;if(closeAllLists(e),!i||i.length<1)return!1;n=-1,(o=document.createElement("div")).setAttribute("id",this.id+"autocomplete-month-list"),o.setAttribute("class","autocomplete-items"),o.style.width="123px",o.style.margin="0 auto",o.style.border="2px solid #d4d0ba",o.style.marginLeft="110px",o.style.position="absolute",o.style.backgroundColor="#fff",this.parentNode.appendChild(o);var u=0,s=t.length;for(l=0;l<s;l++){var c=new RegExp(i,"g");if(t[l].match(c)){if(12==u)break;(r=document.createElement("div")).innerHTML=t[l].replace(i,"<strong>"+i+"</strong>"),r.innerHTML+="<input type='hidden' class='month_active' value='"+t[l]+"'>",r.addEventListener("click",(function(t){e.value=this.getElementsByTagName("input")[0].value,closeAllLists(e)})),r.onmouseover=function(){this.style.backgroundColor="#d4d0ba"},r.onmouseout=function(){this.style.backgroundColor="#fff"},o.appendChild(r),u++}}})),e.addEventListener("keydown",(function(e){var t=document.getElementById(this.id+"autocomplete-month-list");t&&(t=t.getElementsByTagName("div")),40==e.keyCode?(n++,o(t)):38==e.keyCode?(n--,o(t)):13==e.keyCode&&(e.preventDefault(),n>-1&&t&&t[n].click())})),jQuery("#"+a).on("click",(function(e){closeAllLists(e.target)}))}function closeAllLists(e,t){for(var n=document.getElementsByClassName("autocomplete-items"),a=0;a<n.length;a++)t!=n[a]&&t!=e&&n[a].parentNode.removeChild(n[a])}function removeActiveValue(e){for(var t=0;t<e.length;t++)e[t].classList.remove("autocomplete-active")}function yearAutocomplete(e,t){var n,a=e.id;function o(e){if(!e)return!1;removeActiveValue(e),n>=e.length&&(n=0),n<0&&(n=e.length-1),e[n].classList.add("autocomplete-active");var t=jQuery(e[n]);jQuery("#"+a).val(jQuery(".year_active",t).val())}e.addEventListener("input",(function(a){var o,r,l,i=this.value;if(closeAllLists(e),!i||i.length<2||i.length>3)return!1;n=-1,(o=document.createElement("div")).setAttribute("id",this.id+"autocomplete-list"),o.setAttribute("class","autocomplete-items"),o.style.width="10%",o.style.float="right",o.style.border="2px solid #d4d0ba",o.style.marginLeft="236px",o.style.position="absolute",o.style.backgroundColor="#fff",this.parentNode.appendChild(o);var u=1;for(l=0;l<t.length;l++){var s=new RegExp(i,"g");if(t[l].match(s)){if(11==u)break;(r=document.createElement("div")).innerHTML=t[l].replace(i,"<strong>"+i+"</strong>"),r.innerHTML+="<input type='hidden' class='year_active' value='"+t[l]+"'>",r.addEventListener("click",(function(t){e.value=this.getElementsByTagName("input")[0].value,closeAllLists(e)})),r.onmouseover=function(){this.style.backgroundColor="#d4d0ba"},r.onmouseout=function(){this.style.backgroundColor="#fff"},o.appendChild(r),u++}}})),e.addEventListener("keydown",(function(e){var t=document.getElementById(this.id+"autocomplete-list");t&&(t=t.getElementsByTagName("div")),40==e.keyCode?(n++,o(t)):38==e.keyCode?(n--,o(t)):13==e.keyCode&&(e.preventDefault(),n>-1&&t&&t[n].click())})),jQuery("#"+a).on("click",(function(e){closeAllLists(e.target)}))}